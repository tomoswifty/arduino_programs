# モータ制御

## 椿本モータのArduinoによる制御

### まとめ

- Arduino MegaのPWM周波数を上げる必要がある
- ローパスフィルタでPWM信号をアナログ信号に平滑する必要がある

### ローパスフィルタ
- 椿本モータのモータードライバーはアナログ入力にArduinoのPWMを直接入力しても受け付けないため，ローパスフィルタで平滑してアナログ信号にする必要がある
  - 最初に作ったRCローパスフィルタ
    - 動作確認済み
    - コンデンサの容量が大きいため応答が遅い
    - 電解コンデンサは周波数特性が悪い?
![a](./images/RC_LPF_single_stage.png)
  - 2番めに作ったのRCローパスフィルタ
    - 動作確認済み
    - 応答は良いが2段にしたため部品が増えた
![a](./images/RC_LPF_double_stage.png)
  - いずれも手持ちの部品で適当に組んだやつなので，もっといい回路があると思う
### PWM周波数
- Arduino Megaの2番ピンから出るPWMの周波数は490Hz
  - 周波数が低いため，ローパスフィルタで平滑しきれないのでPWMの周波数を上げる必要がある
- マイコンのレジスタを直接いじってPWM周波数を約33kHzに変更(参考:https://qiita.com/srs/items/68981b6e695e6f4468ff)


